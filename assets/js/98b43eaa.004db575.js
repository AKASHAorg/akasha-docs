"use strict";(self.webpackChunkakasha_docs=self.webpackChunkakasha_docs||[]).push([[39208],{69461:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var s=t(74848),o=t(28453);const i={},r="Extension Tutorials",a={id:"extension-tutorials/index",title:"Extension Tutorials",description:"The following section provides a step-by-step guide on how to create different types of extensions using the AKASHA Core. It covers creating necessary folders, initializing the project, and running relevant Yarn commands.",source:"@site/docs/extension-tutorials/index.md",sourceDirName:"extension-tutorials",slug:"/extension-tutorials/",permalink:"/extension-tutorials/",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1719832236e3,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Editor",permalink:"/extensions/editor"},next:{title:"Create an App",permalink:"/extension-tutorials/create-an-app"}},d={},l=[{value:"Bootstrapping a new extension",id:"bootstrapping-a-new-extension",level:2},{value:"Next, let&#39;s setup the build system.",id:"next-lets-setup-the-build-system",level:4},{value:"Setting up NX",id:"setting-up-nx",level:3},{value:"Setting Webpack",id:"setting-webpack",level:3},{value:"Typescript",id:"typescript",level:4},{value:"World Config and Extension Overrides",id:"world-config-and-extension-overrides",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"extension-tutorials",children:"Extension Tutorials"}),"\n",(0,s.jsx)(n.p,{children:"The following section provides a step-by-step guide on how to create different types of extensions using the AKASHA Core. It covers creating necessary folders, initializing the project, and running relevant Yarn commands."}),"\n",(0,s.jsx)(n.h2,{id:"bootstrapping-a-new-extension",children:"Bootstrapping a new extension"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Before we begin make sure you have already followed the ",(0,s.jsx)(n.a,{href:"/dev-quickstart",children:"Dev QuickStart"})," guide"]})}),"\n",(0,s.jsxs)(n.p,{children:["The extensions should be created in the ",(0,s.jsx)(n.code,{children:"extensions"})," folder which is in the root of the AKASHA Core project. So if you want to bootstrap a new app you should do it by creating a new folder in ",(0,s.jsx)(n.code,{children:"extensions/apps"}),", for widgets in ",(0,s.jsx)(n.code,{children:"extensions/widgets"})," and for plugins in ",(0,s.jsx)(n.code,{children:"extensions/plugins"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Start by creating the folder based on what you want to build."}),"\n",(0,s.jsxs)(n.p,{children:["For example to bootstrap a plugin run ",(0,s.jsx)(n.code,{children:"mkdir -p extensions/plugins/my-awesome-plugin"})," from the root of the AKASHA Core project."]}),"\n",(0,s.jsxs)(n.p,{children:["Change directory to the newly created folder and run ",(0,s.jsx)(n.code,{children:"yarn init"})]}),"\n",(0,s.jsxs)(n.p,{children:["This command will create a ",(0,s.jsx)(n.code,{children:"package.json"})," which we will modify it for our needs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json5",metastring:'{3-4,6-7} showLineNumbers title="package.json"',children:'{\n  // name is important at the publishing step. for now it can be anything.\n  "name": "my-awesome-extension"\n  "version": "1.0.0",\n  "packageManager": "yarn@4.1.1",\n  "author": "",\n  "type": "module"\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["The extension name in the ",(0,s.jsx)(n.a,{href:"../extension-publishing/",children:"Extension Publishing"})," step should be the same as the package name you set here."]})}),"\n",(0,s.jsx)(n.p,{children:"In order to maintain consistency between different apps, we recommend creating a similar top level folder structure:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-treeview",metastring:'title="Basic App Directory Structure"',children:"\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 components\n\u2502   \u2502   \u251c\u2500\u2500 app.tsx // root React component of your app\n\u2502   \u2502   \u251c\u2500\u2500 index.tsx // single-spa-react lifecycle exports\n\u2502   \u2514\u2500\u2500 index.tsx // registration function export\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 project.json\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 tsconfig.json\n\u251c\u2500\u2500 yarn.lock\n\u2514\u2500\u2500 webpack.config.js\n"})}),"\n",(0,s.jsx)(n.h4,{id:"next-lets-setup-the-build-system",children:"Next, let's setup the build system."}),"\n",(0,s.jsx)(n.h3,{id:"setting-up-nx",children:"Setting up NX"}),"\n",(0,s.jsxs)(n.p,{children:["NX is used as the build system for the AKASHA Core monorepository.\nTo set it up create a ",(0,s.jsx)(n.code,{children:"project.json"})," file in the root of your app with the following content:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json5",children:'{\n  "name": "my-awesome-extension",\n  "$schema": "../../../node_modules/nx/schemas/project-schema.json",\n  "sourceRoot": "extensions/{extensionType}/my-awesome-extension",\n  "projectType": "application",\n  "targets": {\n    "prepare": {\n      "dependsOn": [\n        "@akashaorg/ui-awf-hooks:build",\n        "@akashaorg/design-system-core:prepare",\n        "@akashaorg/design-system-components:prepare",\n        "@akashaorg/awf-sdk:build",\n        "@akashaorg/ui-lib-extensions:prepare",\n        "@akashaorg/typings:prepare"\n      ],\n      "executor": "nx:run-commands",\n      "options": {\n        "cwd": "extensions/{extensionType}/my-awesome-extension",\n        "command": "tsc --build"\n      }\n    },\n    "build": {\n      "dependsOn": ["prepare"],\n      "executor": "nx:run-commands",\n      "options": {\n        "cwd": "extensions/{extensionType}/my-awesome-extension",\n        "command": "webpack --config webpack.config.cjs"\n      },\n      "outputs": [\n        "{projectRoot}/lib",\n        "{workspaceRoot}/dist/{extensionType}/my-awesome-extension"\n      ]\n    }\n  },\n  "tags": ["scope:extension", "type:{extensionType}"]\n}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Please adjust the following fields with your actual paths.\n",(0,s.jsx)(n.code,{children:"sourceRoot"}),", ",(0,s.jsx)(n.code,{children:"targets.prepare.options.cwd"}),", ",(0,s.jsx)(n.code,{children:"targets.build.options.cwd"})," and replace the ",(0,s.jsx)(n.code,{children:"{extensionType}"})," in ",(0,s.jsx)(n.code,{children:"targets.build.outputs[1]"})," according to what you are building: ",(0,s.jsx)(n.code,{children:"apps"}),", ",(0,s.jsx)(n.code,{children:"widgets"})," or ",(0,s.jsx)(n.code,{children:"plugins"}),".\nFinally, adjust the ",(0,s.jsx)(n.code,{children:"tags"})," field with the replacing the ",(0,s.jsx)(n.code,{children:"{extensionType}"})," accordingly."]})}),"\n",(0,s.jsx)(n.h3,{id:"setting-webpack",children:"Setting Webpack"}),"\n",(0,s.jsx)(n.p,{children:"As you already saw in the previous step, AKASHA Core is using Webpack as module bundler."}),"\n",(0,s.jsxs)(n.p,{children:["To set it up you will have to create a new file ",(0,s.jsx)(n.code,{children:"webpack.config.cjs"})," in the root folder of your extension:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const path = require('path');\nconst baseConfig = require('../../webpack.config');\n\nmodule.exports = Object.assign(baseConfig, {\n  context: path.resolve(__dirname),\n  output: Object.assign(baseConfig.output, {\n    path: path.resolve(__dirname, '../../../dist/{extensionType}/my-awesome-extension'),\n    publicPath: 'auto',\n  }),\n});\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Again, don't forget to replace ",(0,s.jsx)(n.code,{children:"{extensionType}"})," in ",(0,s.jsx)(n.code,{children:"output.path"})," with one of ",(0,s.jsx)(n.code,{children:"apps"}),", ",(0,s.jsx)(n.code,{children:"widgets"})," or ",(0,s.jsx)(n.code,{children:"plugins"})]})}),"\n",(0,s.jsx)(n.h4,{id:"typescript",children:"Typescript"}),"\n",(0,s.jsxs)(n.p,{children:["Typescript is the easiest to setup. Create a new file ",(0,s.jsx)(n.code,{children:"tsconfig.json"})," and paste the following:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "extends": "../../tsconfig.json",\n  "compilerOptions": {\n    "outDir": "./lib",\n    "rootDir": "./src"\n  },\n\n  "include": ["./src/**/*"]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Congrats! The extension is now bootstrapped!\nOf course, there is no code to execute, yet."}),"\n",(0,s.jsx)(n.p,{children:"Event if you create some components, it will not show them anywhere. This is because AppLoader is not aware of the existance of your extension.\nLet's fix this; in development mode, we have provided a way in which you can tell AppLoader that your extension exists and it should be loaded from localhost."}),"\n",(0,s.jsx)(n.h3,{id:"world-config-and-extension-overrides",children:"World Config and Extension Overrides"}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"This section is still a work in progress. Expect some flows to change."})}),"\n",(0,s.jsxs)(n.p,{children:["A deployed instance of the AKASHA Core is actually a ",(0,s.jsx)(n.a,{href:"/glossary#world",children:"world"}),". Worlds contains collection of extensions installed by default and uninstallable by the users.\nThis collection of extensions is defined in the world config. The akasha.world instance has it's config file defined ",(0,s.jsx)(n.a,{href:"https://github.com/AKASHAorg/akasha-core/blob/next/worlds/akasha.world/src/index.ts",children:"here"})]}),"\n",(0,s.jsx)(n.p,{children:"The most important parts of that file are:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"if (__DEV__ || __LOAD_LOCAL_SOURCES__) {\n  registryOverrides = (await import('./registry-overrides')).default;\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["So if ",(0,s.jsx)(n.code,{children:"__DEV__"})," global variable is true (equivalent to ",(0,s.jsx)(n.code,{children:"process.env.NODE_ENV"}),") it will import some registryOverrides (no need to know what they are yet)."]}),"\n",(0,s.jsx)(n.p,{children:"and in the next lines:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'{19} showLineNumbers title="AKASHA World config"',children:" const loaderConfig: WorldConfig = {\n    title: 'AKASHA World',\n    worldIcon: {\n      basePath: '/icons/world/',\n      darkModeSuffix: '_dark',\n      extension: '.png',\n      small: 'small',\n      medium: 'medium',\n      large: 'large',\n    },\n    layout: '@akashaorg/ui-widget-layout',\n    homepageApp: '@akashaorg/app-antenna',\n    defaultApps: [\n      // ..some app names\n    ],\n    defaultWidgets: [\n      //... some widget names\n    ],\n    registryOverrides,\n    socialLinks: [\n      // ...\n    ],\n  };\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Notice that those ",(0,s.jsx)(n.code,{children:"registryOverrides"})," are passed down to ",(0,s.jsx)(n.code,{children:"AppLoader"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Internally the AppLoader will also check if this property is present in the config and will try to load the extensions from there, instead of requesting it from the registry."}),"\n",(0,s.jsxs)(n.p,{children:["So in order to specify from where to load an extension, we must add a new entry to the ",(0,s.jsx)(n.code,{children:"registry-overrides.ts"})," file like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="registry-overrides.ts"',children:"\nconst overrides = [\n  {\n    name: 'my-awesome-extension',\n    integrationType: AkashaAppApplicationType.App, // change this to reflect the kind of extension you are creating\n    sources: [`${origin}/{extensionType}/my-awesome-extension`],\n    ...missingRequiredFields // these are not important in development\n  }\n  // ...the already existing overrides\n]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now going back to the world config, we can specify to load the extension as installed by default."}),"\n",(0,s.jsxs)(n.p,{children:["If you are creating an app, you can add it to the ",(0,s.jsx)(n.code,{children:"defaultApps"})," array and if you are developing a widget, add it to the ",(0,s.jsx)(n.code,{children:"defaultWidgets"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"That's it. Now the AppLoader will know to loaded as default and also where to load it from."}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsx)(n.p,{children:"Your extension is not ready to be built, yet. Please continue to one of the tutorials which will guide you on how to create an extension."})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const o={},i=s.createContext(o);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);